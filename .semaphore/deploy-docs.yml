name: Deploy docs
blocks:
  - name: Deploy docs
    secrets:
      - name: tomo-gh-pages-credentials
    jobs:
      - name: mkdocs gh-deploy
        commands:
          - sem-version python 3.10
          - pip install -r requirements.txt
          - git config --local user.name "Semaphore CI"
          - git config --local user.email ci@mattbrictson.com
          - cat README.md >> docs/index.md
          - cp -R readme_images docs/
          - git remote set-url --push origin "https://mattbrictson:${GITHUB_TOKEN}@github.com/mattbrictson/tomo.git"
          - git fetch
          - mkdocs gh-deploy -m 'Deployed {sha} with mkdocs {version} [ci skip]'
