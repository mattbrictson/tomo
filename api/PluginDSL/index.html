<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Tomo::PluginDSL - Tomo</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../css/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Tomo::PluginDSL";
        var mkdocs_page_input_path = "api/PluginDSL.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script>
<script defer data-domain="tomo-deploy.com" src="https://plausible.io/js/script.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Tomo
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../comparisons/">Comparisons</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../configuration/">Configuration</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Commands</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../commands/init/">init</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../commands/setup/">setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../commands/deploy/">deploy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../commands/run/">run</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../commands/tasks/">tasks</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Plugins</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../plugins/core/">core</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../plugins/bundler/">bundler</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../plugins/env/">env</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../plugins/git/">git</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../plugins/nodenv/">nodenv</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../plugins/puma/">puma</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../plugins/rails/">rails</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../plugins/rbenv/">rbenv</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutorials</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tutorials/deploying-rails-from-scratch/">Deploying Rails From Scratch</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tutorials/writing-custom-tasks/">Writing Custom Tasks</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tutorials/publishing-a-plugin/">Publishing a Plugin</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../Host/">Tomo::Host</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Logger/">Tomo::Logger</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Paths/">Tomo::Paths</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Tomo::PluginDSL</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#instance-methods">Instance methods</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#defaultshash">defaults(hash)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#taskstask_library_class">tasks(*task_library_class)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#helpersmodule">helpers(*module)</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Remote/">Tomo::Remote</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Result/">Tomo::Result</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../TaskLibrary/">Tomo::TaskLibrary</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../testing/MockPluginTester/">Tomo::Testing::MockPluginTester</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Tomo</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>API &raquo;</li>
        
      
    
    <li>Tomo::PluginDSL</li>
    <li class="wy-breadcrumbs-aside">
      
          <a href="https://github.com/mattbrictson/tomo/edit/main/docs/api/PluginDSL.md" class="icon icon-github"
          > Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="tomoplugindsl">Tomo::PluginDSL</h1>
<p>A tomo plugin is defined by a Ruby module that extends Tomo::PluginDSL. A plugin definition can specify three things:</p>
<ul>
<li>Default settings</li>
<li>Tasks</li>
<li>Helpers</li>
</ul>
<p>Here is the bundler plugin as an example:</p>
<pre><code class="language-ruby">require_relative &quot;bundler/helpers&quot;
require_relative &quot;bundler/tasks&quot;

module Tomo::Plugin::Bundler
  extend Tomo::PluginDSL

  tasks Tomo::Plugin::Bundler::Tasks
  helpers Tomo::Plugin::Bundler::Helpers

  defaults bundler_config_path: &quot;.bundle/config&quot;,
           bundler_deployment:  true,
           bundler_gemfile:     nil,
           bundler_jobs:        &quot;4&quot;,
           bundler_path:        &quot;%{shared_path}/bundle&quot;,
           bundler_retry:       &quot;3&quot;,
           bundler_version:     nil,
           bundler_without:     %w[development test]
end
</code></pre>
<p>The above plugin defines several default settings, defines tasks using a <a href="../TaskLibrary/">TaskLibrary</a> named <code>Tomo::Plugin::Bundler::Tasks</code>, and defines helpers in a module named <code>Tomo::Plugin::Bundler::Helpers</code>.</p>
<p>Refer to the <a href="../../tutorials/publishing-a-plugin/">Publishing a Plugin</a> tutorial for more information about packaging and distributing tomo plugins.</p>
<h2 id="instance-methods">Instance methods</h2>
<h3 id="defaultshash">defaults(hash)</h3>
<p>Specify default settings that will be applied when this plugin is loaded. Although not strictly necessary, it is best practice to list all required and optional settings that are used by the plugin, even if the default values are <code>nil</code>. This lets other developers know what setting names are expected when using the plugin.</p>
<p>Settings must use symbol keys and typically String values, although any Ruby type is possible. Strings can contain <a href="../../configuration/#interpolation">interpolated values</a>.</p>
<pre><code class="language-ruby">module Tomo::Plugin::Bundler
  extend Tomo::PluginDSL

  defaults bundler_config_path: &quot;.bundle/config&quot;,
           bundler_deployment:  true,
           bundler_gemfile:     nil,
           bundler_jobs:        &quot;4&quot;,
           bundler_path:        &quot;%{shared_path}/bundle&quot;,
           bundler_retry:       &quot;3&quot;,
           bundler_version:     nil,
           bundler_without:     %w[development test]
end
</code></pre>
<h3 id="taskstask_library_class">tasks(*task_library_class)</h3>
<p>Specify the tasks that will be defined by this plugin by supplying one or more <a href="../TaskLibrary/">TaskLibrary</a> classes. The public instance methods of each class will be turned into tomo tasks.</p>
<pre><code class="language-ruby">class Tomo::Plugin::Git::Tasks &lt; Tomo::TaskLibrary
  def clone
    # ...
  end

  def create_release
    # ...
  end
end

class Tomo::Plugin::Git
  extend Tomo::PluginDSL

  tasks Tomo::Plugin::Git::Tasks
end
</code></pre>
<p>You can use <code>tasks self</code> to define a plugin and its tasks together as a single class:</p>
<pre><code class="language-ruby">class Tomo::Plugin::Git &lt; Tomo::TaskLibrary
  extend Tomo::PluginDSL
  tasks self

  def clone
    # ...
  end

  def create_release
    # ...
  end
end
</code></pre>
<h3 id="helpersmodule">helpers(*module)</h3>
<p>Specify the helpers that will be defined by this plugin by supplying one or more plain Ruby modules. The modules will be mixed in at runtime to extend the <a href="../Remote/">Remote</a> interface with additional methods.</p>
<pre><code class="language-ruby">module Tomo::Plugin::Core::Helpers
  def ln_sf(target, link, **run_opts)
    # ...
  end

  def mkdir_p(*directories, **run_opts)
    # ...
  end
end

module Tomo::Plugin::Core
  extend Tomo::PluginDSL

  helpers Tomo::Plugin::Core::Helpers
end
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../Paths/" class="btn btn-neutral float-left" title="Tomo::Paths"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../Remote/" class="btn btn-neutral float-right" title="Tomo::Remote">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/mattbrictson/tomo/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../Paths/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../Remote/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../js/extra.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
